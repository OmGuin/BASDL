# BASDL: A Deep Learning Approach to Higher Concentration Burst Analysis Spectroscopy

## Code Explanation

`Tentsim_BAS_simulation_basus.ipynb`: Simulation program for BAS data. Outputs randomly sampled photon arrival times in TAMU format.

`Preprocessing_basus.ipynb`: Preprocessing code for BAS data. 
- Input: TAMU-style BAS data.
- Output: `.npz` file containing handles, datastat, etc. Check `save_preprocessed(..)` for details

`example_binning.py`: Example of reading photon TOAs from a file and obtaining I vs. t histogram. 
- For details on extracting peaks, check `Preprocessing_basus.ipynb` or look at more modern functions from scipy (e.g. `scipy.find_peaks()`). Example in `testing_bangs_june3/bangs_analysis.ipynb`

`data_generation_lowconc.ipynb`: A concatenated version of simulation and preprocessing code to generate large datasets for training DL models. Uses randomzed species, amplitude, and concentration settings to generate diverse data. Compatible with Google Colab and Princeton's Della Computing Cluster. **Only concentrations under single-particle limit**. 

### Datasets
Contains .zip files generated by `data_generation_lowconc.ipynb` for DL training. Unpacking information in `training_transformer.ipynb`

### MATLAB_originals
Contains BAS MATLAB files including preprocessing, simulation, and high conc. simulation

### Models
Contains trained transformer models

### python_conversions_originals
Direct python translations from MATLAB_orignals

### real_data
100nm Tetraspecs files + results & bang beads files + analysis

### sim_data
Data generated from `Tentsim_BAS_simulation_basus.ipynb`
- Older files have less features (i.e. saving burst-species info)

### unsupervised_approaches
`CVAE.ipynb` Variational Autoencoder implementation. Also contains convolutional VAE which was unsuccessful. Overall results were very poor.

`RLD.ipynb` Richardson-Lucy Deconvolution implementation. Wasn't hypothesized to succeed, and didn't due to the ill-posed nature of the task

`UMAP.ipynb` UMAP implementation on both burst windows and burst features. Concluded that there was no inherent parameter in the bursts that could be used to resolve species differences.

### testing_bangs_june3
First hands-on experience with BAS data. :)








